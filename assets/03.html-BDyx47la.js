import{_ as s}from"./image-20210116223917540-UTbh78Z7.js";import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,l,o as t}from"./app-DN83cdpr.js";const n={};function h(p,i){return t(),e("div",null,i[0]||(i[0]=[l(`<h1 id="查看-jvm-统计信息" tabindex="-1"><a class="header-anchor" href="#查看-jvm-统计信息"><span>查看 JVM 统计信息</span></a></h1><p><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jstat.html#BEHHGFAE" target="_blank" rel="noopener noreferrer">jstat</a> 可以查询以下几类等的：</p><ul><li>类装载</li><li>垃圾收集</li><li>JIT 编译</li></ul><h2 id="语法" tabindex="-1"><a class="header-anchor" href="#语法"><span>语法</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jstat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">generalOption</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">outputOptions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vmid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">interval[s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ms]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">count</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ]</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><p>generalOption：单个常规命令行选项</p><p>可以通过 <code>jstat -options</code> 输出支持的命令，比如常见的有</p><ul><li><code>-class</code>：类加载</li><li><code>-compiler</code>：JIT 编译信息</li><li><code>-gc</code>：垃圾回收信息</li><li><code>-printcompilation</code>：显示Java HotSpot VM编译方法统计信息</li></ul></li><li><p>outputOptions：一个或由单个的多输出选项</p></li><li><p>vmid：虚拟机标识符，一般用进程 id，还可以写完整的远程服务器上的进程 id</p></li><li><p>interval：采样间隔，默认单位是毫秒（可以为秒），制定后，则间隔多长时间输出一次</p></li><li><p>count：要显示的样本数量，也就是输出几次</p></li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p>再次提示：去阅读官方该工具的介绍</p></div><h2 id="类装载信息" tabindex="-1"><a class="header-anchor" href="#类装载信息"><span>类装载信息</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mrcode:~</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mrcode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">jstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -class</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 46129</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Loaded</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Unloaded</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  3315</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  6334.5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       1.36</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>类加载器统计信息：</p><ul><li><code>Loaded</code>：已加载的类数。</li><li><code>Bytes</code>：加载的 kB 数。</li><li><code>Unloaded</code>：卸载的类数。</li><li><code>Bytes</code>：卸载的KB数。</li><li><code>Time</code>：执行类加载和卸载操作所花费的时间。</li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p>再次提示：去阅读官方该工具的介绍，上面的每列含义都是文档中复制过来的</p></div><h2 id="垃圾收集信息" tabindex="-1"><a class="header-anchor" href="#垃圾收集信息"><span>垃圾收集信息</span></a></h2><p>与垃圾收集信息有关的选项有：</p><ul><li><code>-gc</code></li><li><code>-gcutil</code></li><li><code>-gccause</code></li><li><code>-gcnew</code></li><li><code>-gcold</code></li></ul><h3 id="gc" tabindex="-1"><a class="header-anchor" href="#gc"><span><code>-gc</code></span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mrcode:~</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mrcode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">jstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -gc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 46129</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> S0C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  S1C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  S0U</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  S1U</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   EC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    EU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    OC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     OU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    MC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   MU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  CCSC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  CCSU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  YGC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   YGCT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  FGC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  FGCT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   GCT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">10752.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10752.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  4479.4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 65536.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 15266.7</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  175104.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  144.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  18048.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17391.3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2176.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2004.6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0.004</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0.000</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0.004</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>S0C、S1C、S0U、S1U</code>：S0 和 S1 的总量与使用量</li><li><code>EC、EU</code>：Eden 区总量与使用量</li><li><code>OC、OU</code>：Old 区总量与使用量</li><li><code>MC、MU</code>：Metaspace 区总量与使用量</li><li><code>CCSC、CCSU</code>：压缩类空间总量与使用量</li><li><code>YGC、YGCT</code>：YoungGC 的次数与时间</li><li><code>FGC、FGCT</code>：FullGC 的次数与时间</li><li><code>GCT</code>：总的 GC 时间</li></ul><p>以上的参数信息对于我们的 gc 调优来说相当重要，再配不停的输出每秒的 GC 信息，也能很清楚的看到 GC 的变化。</p><p>还有其他的选项，可以输出各种的信息，详细请查阅文档。</p><h2 id="jvm-内存结构" tabindex="-1"><a class="header-anchor" href="#jvm-内存结构"><span>JVM 内存结构</span></a></h2><p>根据前面的输出信息，可以简单的把 JVM 内存结构画出来</p><figure><img src="`+s+`" alt="image-20210116223917540" tabindex="0" loading="lazy"><figcaption>image-20210116223917540</figcaption></figure><ul><li><p>堆区：JVM 堆内存</p><p>由以下两部分组成：</p><ol><li>Young：中的 S0 和 S1 在同一时间只会有一个有值，另一个为 0</li><li>Old</li></ol></li><li><p>非堆区：操作系统内存（JDK 8 中称为 Metaspace）</p><ul><li><p>CCS：启用了压缩指针时，就会存在该区域</p></li><li><p>CodeCache：JIT 的代码信息，把 JAVA 代码转换成 native（C） 代码</p><p>如果没有开启 JIT 编译的话，这块内存也不存在</p></li></ul></li></ul><h2 id="jit-编译" tabindex="-1"><a class="header-anchor" href="#jit-编译"><span>JIT 编译</span></a></h2><p>有两个选项：</p><ul><li><code>-compiler</code>：显示有关 Java HotSpot VM 即时编译器行为的统计信息。</li><li><code>-printcompilation</code>：显示 Java HotSpot VM 编译方法统计信息。</li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mrcode:~</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mrcode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">jstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -compiler</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 47503</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Compiled</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Failed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Invalid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   Time</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   FailedType</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> FailedMethod</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      24</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0.02</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">          0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>Compiled</code>：执行的编译任务数。</p></li><li><p><code>Failed</code>：编译任务数失败。</p></li><li><p><code>Invalid</code>：无效的编译任务数。</p></li><li><p><code>Time</code>：执行编译任务所花费的时间。</p></li><li><p><code>FailedType</code>：上次失败的编译的编译类型。</p></li><li><p><code>FailedMethod</code>：上次失败的编译的类名和方法。</p></li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mrcode:~</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mrcode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">jstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -printcompilation</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 47503</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Compiled</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Method</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      24</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> java/net/URL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> getAuthority</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>Compiled</code>：由最近编译的方法执行的编译任务数。</p></li><li><p><code>Size</code>：最近编译的方法的字节码的字节数。</p></li><li><p><code>Type</code>：最近编译的方法的编译类型。</p></li><li><p><code>Method</code>：标识最近编译的方法的类名和方法名。</p><p>类名使用斜杠（<code>/</code>）代替点（<code>.</code>）作为名称空间分隔符。方法名称是指定类中的方法。这两个字段的格式与 <code>HotSpot -XX:+PrintCompilation</code> 选项一致。</p></li></ul>`,31)]))}const o=a(n,[["render",h],["__file","03.html.vue"]]),c=JSON.parse('{"path":"/monitor-tuning/01/03.html","title":"查看 JVM 统计信息","lang":"zh-CN","frontmatter":{"tags":["jstat"],"description":"查看 JVM 统计信息 jstat 可以查询以下几类等的： 类装载 垃圾收集 JIT 编译 语法 generalOption：单个常规命令行选项 可以通过 jstat -options 输出支持的命令，比如常见的有 -class：类加载 -compiler：JIT 编译信息 -gc：垃圾回收信息 -printcompilation：显示Java Hot...","head":[["meta",{"property":"og:url","content":"https://www.pvzge.com/blog_technical/monitor-tuning/01/03.html"}],["meta",{"property":"og:title","content":"查看 JVM 统计信息"}],["meta",{"property":"og:description","content":"查看 JVM 统计信息 jstat 可以查询以下几类等的： 类装载 垃圾收集 JIT 编译 语法 generalOption：单个常规命令行选项 可以通过 jstat -options 输出支持的命令，比如常见的有 -class：类加载 -compiler：JIT 编译信息 -gc：垃圾回收信息 -printcompilation：显示Java Hot..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-12-21T11:38:46.000Z"}],["meta",{"property":"article:tag","content":"jstat"}],["meta",{"property":"article:modified_time","content":"2024-12-21T11:38:46.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"查看 JVM 统计信息\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-12-21T11:38:46.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"LMYY\\",\\"url\\":\\"https://gaozih.com\\"}]}"]]},"headers":[{"level":2,"title":"语法","slug":"语法","link":"#语法","children":[]},{"level":2,"title":"类装载信息","slug":"类装载信息","link":"#类装载信息","children":[]},{"level":2,"title":"垃圾收集信息","slug":"垃圾收集信息","link":"#垃圾收集信息","children":[{"level":3,"title":"-gc","slug":"gc","link":"#gc","children":[]}]},{"level":2,"title":"JVM 内存结构","slug":"jvm-内存结构","link":"#jvm-内存结构","children":[]},{"level":2,"title":"JIT 编译","slug":"jit-编译","link":"#jit-编译","children":[]}],"git":{"createdTime":1734781126000,"updatedTime":1734781126000,"contributors":[{"name":"liao_rh","username":"liao_rh","email":"993929808@qq.com","commits":1,"url":"https://github.com/liao_rh"}]},"readingTime":{"minutes":3.06,"words":919},"filePathRelative":"monitor-tuning/01/03.md","localizedDate":"2024年12月21日","autoDesc":true}');export{o as comp,c as data};
