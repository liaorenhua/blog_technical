import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,l as a,o as n}from"./app-DNFRjLSh.js";const e={};function h(l,i){return n(),t("div",null,i[0]||(i[0]=[a(`<h1 id="ngx-http-stub-status-监控链接信息" tabindex="-1"><a class="header-anchor" href="#ngx-http-stub-status-监控链接信息"><span>ngx_http_stub_status 监控链接信息</span></a></h1><p>是 nginx 自带的一个模块，可以使用命令查看是否已经编译进来了</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -V</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx/1.17.4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">built</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> by</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 16.00.40219.01</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 80x86</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">built</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> with</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OpenSSL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1.1.1d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Sep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2019</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TLS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SNI</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> support</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enabled</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">configure</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> arguments:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-cc=cl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --builddir=objs.msvc8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-debug</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --prefix=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --conf-path=conf/nginx.conf</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --pid-path=logs/nginx.pid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --http-log-path=logs/access.log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --error-log-path=logs/error.log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --sbin-path=nginx.exe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --http-client-body-temp-path=temp/client_body_temp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --http-proxy-temp-path=temp/proxy_temp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --http-fastcgi-temp-path=temp/fastcgi_temp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --http-scgi-temp-path=temp/scgi_temp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --http-uwsgi-temp-path=temp/uwsgi_temp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-cc-opt=-DFD_SETSIZE=1024</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-pcre=objs.msvc8/lib/pcre-8.43</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-zlib=objs.msvc8/lib/zlib-1.2.11</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_v2_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_realip_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_addition_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_sub_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_dav_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_stub_status_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_flv_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_mp4_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_gunzip_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_gzip_static_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_auth_request_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_random_index_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_secure_link_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_slice_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-mail</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-stream</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-openssl=objs.msvc8/lib/openssl-1.1.1d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-openssl-opt=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;no-asm no-tests -D_WIN32_WINNT=0x0501&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-http_ssl_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-mail_ssl_module</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --with-stream_ssl_module</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>也就是这个 <code>--with-http_stub_status_module</code></p><p>增加配置</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /nginx_status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> stub_status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 开启这个状态信息</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> access_log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> off</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> allow</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 127.0.0.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 运行本机访问，其他的都拒绝</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> deny</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> all</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新加载配置后，访问 <code>http://localhost/nginx_status</code>，有以下的内容输出</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Active connections: 2 									</span></span>
<span class="line"><span>server accepts handled requests</span></span>
<span class="line"><span> 4 			4 				2				3 </span></span>
<span class="line"><span>Reading: 0 Writing: 1 Waiting: 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以上信息与如何使用在官方文档中也有，<a href="http://nginx.org/en/docs/http/ngx_http_stub_status_module.html" target="_blank" rel="noopener noreferrer">就是具体的模块文档里面</a></p><ul><li><p>Active connections</p><p>当前活动的客户端连接数，包括<code>Waiting</code>连接数。</p></li><li><p>accepts</p><p>接受的客户端连接总数。</p></li><li><p>handled</p><p>已处理的连接总数。通常，参数值与 <code>accepts</code> 除非达到某些资源限制（例如， <a href="http://nginx.org/en/docs/ngx_core_module.html#worker_connections" target="_blank" rel="noopener noreferrer">worker_connections</a> 限制）相同。</p></li><li><p>requests</p><p>客户端请求总数。</p></li><li><p>Reading</p><p>nginx 正在读取请求标头的当前连接数。</p></li><li><p>Writing</p><p>nginx 正在将响应写回到客户端的当前连接数。</p></li><li><p>Waiting</p><p>当前等待请求的空闲客户端连接数。</p></li></ul><p>其中后 5 个信息比较重要，可以知道当前的 nginx 是否繁忙</p>`,11)]))}const r=s(e,[["render",h],["__file","01.html.vue"]]),d=JSON.parse('{"path":"/monitor-tuning/05/01.html","title":"ngx_http_stub_status 监控链接信息","lang":"zh-CN","frontmatter":{"description":"ngx_http_stub_status 监控链接信息 是 nginx 自带的一个模块，可以使用命令查看是否已经编译进来了 也就是这个 --with-http_stub_status_module 增加配置 重新加载配置后，访问 http://localhost/nginx_status，有以下的内容输出 以上信息与如何使用在官方文档中也有，就是具体的...","head":[["meta",{"property":"og:url","content":"https://www.pvzge.com/blog_technical/monitor-tuning/05/01.html"}],["meta",{"property":"og:title","content":"ngx_http_stub_status 监控链接信息"}],["meta",{"property":"og:description","content":"ngx_http_stub_status 监控链接信息 是 nginx 自带的一个模块，可以使用命令查看是否已经编译进来了 也就是这个 --with-http_stub_status_module 增加配置 重新加载配置后，访问 http://localhost/nginx_status，有以下的内容输出 以上信息与如何使用在官方文档中也有，就是具体的..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-12-21T11:38:46.000Z"}],["meta",{"property":"article:modified_time","content":"2024-12-21T11:38:46.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"ngx_http_stub_status 监控链接信息\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-12-21T11:38:46.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Leo\\",\\"url\\":\\"https://blog.csdn.net/liao_rh\\"}]}"]]},"headers":[],"git":{"createdTime":1734781126000,"updatedTime":1734781126000,"contributors":[{"name":"liao_rh","username":"liao_rh","email":"993929808@qq.com","commits":1,"url":"https://github.com/liao_rh"}]},"readingTime":{"minutes":1.43,"words":429},"filePathRelative":"monitor-tuning/05/01.md","localizedDate":"2024年12月21日","autoDesc":true}');export{r as comp,d as data};
